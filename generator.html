<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DV360 Campaign Strategy Generator</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', -apple-system, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 40px 20px;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    h1 {
      text-align: center;
      color: white;
      margin-bottom: 10px;
      font-size: 2rem;
    }

    .subtitle {
      text-align: center;
      color: rgba(255,255,255,0.8);
      margin-bottom: 30px;
    }

    .main-grid {
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 30px;
    }

    @media (max-width: 1024px) {
      .main-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Form Panel */
    .form-panel {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      height: fit-content;
    }

    .form-panel h2 {
      color: #667eea;
      margin-bottom: 25px;
      font-size: 1.3rem;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      color: #333;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .form-group label span {
      color: #e74c3c;
    }

    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }

    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    .form-row {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px;
    }

    .btn-generate {
      width: 100%;
      padding: 15px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: opacity 0.3s, transform 0.2s;
      margin-top: 10px;
    }

    .btn-generate:hover {
      opacity: 0.9;
      transform: translateY(-2px);
    }

    .btn-generate:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    /* Result Panel */
    .result-panel {
      background: white;
      border-radius: 16px;
      padding: 30px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      min-height: 600px;
    }

    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      border-bottom: 2px solid #667eea;
      padding-bottom: 10px;
    }

    .result-header h2 {
      color: #667eea;
      font-size: 1.3rem;
    }

    .result-actions {
      display: flex;
      gap: 10px;
    }

    .btn-action {
      padding: 8px 16px;
      border: 2px solid #667eea;
      background: white;
      color: #667eea;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 500;
      transition: all 0.3s;
    }

    .btn-action:hover {
      background: #667eea;
      color: white;
    }

    .btn-action:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    /* Grade Badge */
    .grade-section {
      text-align: center;
      padding: 30px;
      background: #f8f9fa;
      border-radius: 12px;
      margin-bottom: 25px;
    }

    .grade-badge {
      display: inline-block;
      font-size: 3rem;
      font-weight: 700;
      width: 100px;
      height: 100px;
      line-height: 100px;
      border-radius: 50%;
      color: white;
      margin-bottom: 10px;
    }

    .grade-S { background: linear-gradient(135deg, #00b894, #00cec9); }
    .grade-A { background: linear-gradient(135deg, #0984e3, #74b9ff); }
    .grade-B { background: linear-gradient(135deg, #fdcb6e, #f39c12); }
    .grade-C { background: linear-gradient(135deg, #e17055, #d63031); }
    .grade-D { background: linear-gradient(135deg, #636e72, #2d3436); }

    .grade-score {
      font-size: 1.2rem;
      color: #666;
    }

    /* KPI Grid */
    .kpi-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 15px;
      margin-bottom: 25px;
    }

    .kpi-card {
      background: #f8f9fa;
      border-radius: 10px;
      padding: 15px;
      text-align: center;
    }

    .kpi-card .value {
      font-size: 1.4rem;
      font-weight: 700;
      color: #667eea;
    }

    .kpi-card .label {
      font-size: 0.8rem;
      color: #666;
      margin-top: 5px;
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 2px solid #e0e0e0;
      margin-bottom: 20px;
    }

    .tab {
      padding: 12px 20px;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      margin-bottom: -2px;
      font-weight: 500;
      color: #666;
      transition: all 0.3s;
    }

    .tab:hover {
      color: #667eea;
    }

    .tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* Tables */
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 15px 0;
      font-size: 0.9rem;
    }

    th {
      background: #667eea;
      color: white;
      padding: 12px;
      text-align: left;
    }

    td {
      padding: 12px;
      border-bottom: 1px solid #e0e0e0;
    }

    tr:nth-child(even) {
      background: #f8f9fa;
    }

    /* Budget Bar */
    .budget-bar {
      display: flex;
      height: 35px;
      border-radius: 6px;
      overflow: hidden;
      margin: 15px 0;
    }

    .budget-segment {
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 0.85rem;
      font-weight: 500;
    }

    /* Info Boxes */
    .info-box {
      padding: 15px;
      border-radius: 8px;
      margin: 15px 0;
    }

    .info-box.success {
      background: #d4edda;
      border-left: 4px solid #28a745;
    }

    .info-box.warning {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
    }

    .info-box.info {
      background: #e7f1ff;
      border-left: 4px solid #667eea;
    }

    /* Placeholder */
    .placeholder {
      text-align: center;
      padding: 100px 40px;
      color: #999;
    }

    .placeholder-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    /* Loading */
    .loading {
      text-align: center;
      padding: 60px;
    }

    .spinner {
      width: 50px;
      height: 50px;
      border: 4px solid #e0e0e0;
      border-top-color: #667eea;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Validation List */
    .validation-list {
      list-style: none;
    }

    .validation-item {
      padding: 10px 15px;
      margin: 8px 0;
      border-radius: 6px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .validation-item.pass {
      background: #d4edda;
    }

    .validation-item.warning {
      background: #fff3cd;
    }

    .validation-item.fail {
      background: #f8d7da;
    }

    .validation-icon {
      font-size: 1.2rem;
    }

    /* Print Styles */
    @media print {
      * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
      }

      body {
        background: white !important;
        padding: 20px !important;
      }

      .container {
        max-width: 100% !important;
      }

      h1, .subtitle {
        color: #333 !important;
        display: none !important;
      }

      .main-grid {
        display: block !important;
      }

      .form-panel {
        display: none !important;
      }

      .result-panel {
        box-shadow: none !important;
        padding: 0 !important;
      }

      .result-header h2 {
        display: none !important;
      }

      .result-actions {
        display: none !important;
      }

      /* Show all tab contents in print */
      .tabs {
        display: none !important;
      }

      #tab-structure,
      #tab-targeting,
      #tab-bidding,
      #tab-validation {
        display: block !important;
        visibility: visible !important;
        opacity: 1 !important;
        page-break-inside: avoid;
        margin-bottom: 25px;
        border: 1px solid #ccc;
        padding: 20px;
        border-radius: 8px;
      }

      #tab-structure::before,
      #tab-targeting::before,
      #tab-bidding::before,
      #tab-validation::before {
        display: block !important;
        font-size: 1.1rem;
        font-weight: 700;
        color: #667eea !important;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 2px solid #667eea;
      }

      #tab-structure::before {
        content: "1. ìº í˜ì¸ êµ¬ì¡°";
      }

      #tab-targeting::before {
        content: "2. íƒ€ê²ŸíŒ… ì „ëµ";
      }

      #tab-bidding::before {
        content: "3. ì…ì°° ì „ëµ";
      }

      #tab-validation::before {
        content: "4. ê²€ì¦ ê²°ê³¼";
      }

      .grade-section {
        background: #f8f9fa !important;
        margin-bottom: 20px;
      }

      .grade-badge {
        width: 80px !important;
        height: 80px !important;
        line-height: 80px !important;
        font-size: 2.5rem !important;
      }

      .kpi-grid {
        display: grid !important;
        grid-template-columns: repeat(4, 1fr) !important;
        gap: 10px !important;
      }

      .kpi-card {
        background: #f8f9fa !important;
        border: 1px solid #e0e0e0 !important;
      }

      .budget-bar {
        display: flex !important;
        height: 30px !important;
      }

      .budget-segment {
        color: white !important;
      }

      table {
        page-break-inside: avoid;
        width: 100% !important;
      }

      th {
        background: #667eea !important;
        color: white !important;
      }

      .info-box {
        background: #e7f1ff !important;
        border-left: 4px solid #667eea !important;
      }

      .info-box.success {
        background: #d4edda !important;
        border-left-color: #28a745 !important;
      }

      .validation-item.pass {
        background: #d4edda !important;
      }

      .validation-item.warning {
        background: #fff3cd !important;
      }

      .validation-item.fail {
        background: #f8d7da !important;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <h1>DV360 Campaign Strategy Generator</h1>
  <p class="subtitle">ìº í˜ì¸ ì •ë³´ë¥¼ ì…ë ¥í•˜ë©´ AIê°€ ìµœì ì˜ DV360 ì „ëµì„ ìƒì„±í•©ë‹ˆë‹¤</p>

  <div class="main-grid">
    <!-- Form Panel -->
    <div class="form-panel">
      <h2>ìº í˜ì¸ ì •ë³´ ì…ë ¥</h2>

      <form id="campaignForm">
        <div class="form-group">
          <label>ì—…ì¢… <span>*</span></label>
          <select id="industry" required>
            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
            <option value="ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ">ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ</option>
            <option value="êµìœ¡">êµìœ¡</option>
            <option value="ê¸ˆìœµ">ê¸ˆìœµ</option>
            <option value="ì´ì»¤ë¨¸ìŠ¤_íŒ¨ì…˜">ì´ì»¤ë¨¸ìŠ¤/íŒ¨ì…˜</option>
            <option value="ì„œë¹„ìŠ¤_ìš´ì„¸ìƒë‹´">ì„œë¹„ìŠ¤/ìš´ì„¸ìƒë‹´</option>
            <option value="ê¸°íƒ€">ê¸°íƒ€</option>
          </select>
        </div>

        <div class="form-group">
          <label>ì œí’ˆ/ì„œë¹„ìŠ¤ëª… <span>*</span></label>
          <input type="text" id="productService" placeholder="ì˜ˆ: ë¹„íƒ€ë¯¼C ì˜ì–‘ì œ" required>
        </div>

        <div class="form-group">
          <label>íƒ€ê²Ÿ ê³ ê° <span>*</span></label>
          <input type="text" id="targetDemo" placeholder="ì˜ˆ: 30-50ì„¸ ì—¬ì„±" required>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>í¼ë„ ë‹¨ê³„ <span>*</span></label>
            <select id="funnelStage" required>
              <option value="ì¸ì§€(Awareness)">ì¸ì§€ (Awareness)</option>
              <option value="ê³ ë ¤(Consideration)">ê³ ë ¤ (Consideration)</option>
              <option value="ì „í™˜(Conversion)" selected>ì „í™˜ (Conversion)</option>
            </select>
          </div>

          <div class="form-group">
            <label>ìº í˜ì¸ ëª©í‘œ <span>*</span></label>
            <select id="campaignGoal" required>
              <option value="Brand Awareness">ë¸Œëœë“œ ì¸ì§€</option>
              <option value="Lead Generation" selected>ë¦¬ë“œ ìƒì„±</option>
              <option value="Purchase">êµ¬ë§¤ ì „í™˜</option>
              <option value="App Install">ì•± ì„¤ì¹˜</option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>ì›” ì˜ˆì‚° (ì›) <span>*</span></label>
            <input type="number" id="budget" placeholder="3000000" required min="1000000">
          </div>

          <div class="form-group">
            <label>ìº í˜ì¸ ê¸°ê°„ (ì¼)</label>
            <input type="number" id="duration" value="30" min="7" max="90">
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label>KPI ìœ í˜• <span>*</span></label>
            <select id="kpiType" required>
              <option value="CPA">CPA (ì „í™˜ë‹¹ ë¹„ìš©)</option>
              <option value="ROAS">ROAS (ê´‘ê³ ë¹„ ëŒ€ë¹„ ë§¤ì¶œ)</option>
            </select>
          </div>

          <div class="form-group">
            <label>KPI ëª©í‘œê°’ <span>*</span></label>
            <input type="number" id="kpiTarget" placeholder="CPA: 10000 / ROAS: 300" required>
          </div>
        </div>

        <div class="form-group">
          <label>ì§€ì—­ íƒ€ê²ŸíŒ…</label>
          <input type="text" id="geoTargets" value="ëŒ€í•œë¯¼êµ­ ì „ì—­" placeholder="ëŒ€í•œë¯¼êµ­ ì „ì—­">
        </div>

        <div class="form-group">
          <label>ì¶”ê°€ ìš”êµ¬ì‚¬í•­ (ì„ íƒ)</label>
          <textarea id="constraints" rows="2" placeholder="ì˜ˆ: ëª¨ë°”ì¼ ì „ìš©, ì•¼ê°„ ì‹œê°„ëŒ€ ì§‘ì¤‘ ë“±"></textarea>
        </div>

        <button type="submit" class="btn-generate" id="generateBtn">
          ì „ëµ ìƒì„±í•˜ê¸°
        </button>
      </form>
    </div>

    <!-- Result Panel -->
    <div class="result-panel">
      <div class="result-header">
        <h2>ìƒì„±ëœ ìº í˜ì¸ ì „ëµ</h2>
        <div class="result-actions">
          <button class="btn-action" id="btnDownloadPdf" disabled>PDF ë‹¤ìš´ë¡œë“œ</button>
        </div>
      </div>

      <div id="resultContent">
        <div class="placeholder">
          <div class="placeholder-icon">ğŸ“Š</div>
          <p>ì™¼ìª½ í¼ì— ìº í˜ì¸ ì •ë³´ë¥¼ ì…ë ¥í•˜ê³ <br>"ì „ëµ ìƒì„±í•˜ê¸°" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</p>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// ============================================================================
// DV360 Strategy Generator - JavaScript Implementation
// ============================================================================

// Knowledge Base (Golden Dataset)
const GOLDEN_DATASET = {
  "ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ": {
    template_id: "HEALTH_SUPPLEMENT",
    target_demographic: "40-60ì„¸",
    budget_allocation: { prospecting: 0.5, remarketing: 0.5 },
    benchmarks: { cpa: 15000, conversion_rate: 1.8, roas: 2.5 },
    audiences: {
      affinity: "ê±´ê°•/í”¼íŠ¸ë‹ˆìŠ¤, ì›°ë¹™, ìì—°ì£¼ì˜",
      inmarket: "ê±´ê°•ë³´ì¡°ì‹í’ˆ, ë¹„íƒ€ë¯¼/ë³´ì¶©ì œ",
      custom: "ê´€ì ˆ, í˜ˆë‹¹, ë©´ì—­ë ¥, ê±´ê°•ê¸°ëŠ¥ì‹í’ˆ"
    },
    key_learnings: [
      "40-60ì„¸ íƒ€ê²Ÿ CPA 30% ë‚®ìŒ",
      "ê±´ê°• ê´€ë ¨ ê¸°ì‚¬ ì»¨í…ì¸  ì£¼ë³€ ë°°ì¹˜ íš¨ê³¼ì ",
      "ì•„ì¹¨ 6-9ì‹œ, ì €ë… 8-10ì‹œ ì „í™˜ìœ¨ ë†’ìŒ"
    ]
  },
  "êµìœ¡": {
    template_id: "EDUCATION",
    target_demographic: "25-45ì„¸",
    budget_allocation: { prospecting: 0.6, remarketing: 0.4 },
    benchmarks: { cpa: 25000, conversion_rate: 2.2, roas: 3.0 },
    audiences: {
      affinity: "êµìœ¡, ìê¸°ê³„ë°œ, ì»¤ë¦¬ì–´",
      inmarket: "êµìœ¡ ì„œë¹„ìŠ¤, ì˜¨ë¼ì¸ í•™ìŠµ",
      custom: "ìê²©ì¦, ì˜ì–´, ì½”ë”©, ì·¨ì—…"
    },
    key_learnings: [
      "ì‹ í•™ê¸° ì‹œì¦Œ(2-3ì›”, 8-9ì›”) CPA 40% ê°ì†Œ",
      "ì§ì¥ì¸ íƒ€ê²Ÿ ì €ë… 9-11ì‹œ ì „í™˜ìœ¨ ìµœê³ ",
      "ë¬´ë£Œ ì²´í—˜/ìƒ˜í”Œ ê°•ì˜ CTA íš¨ê³¼ì "
    ]
  },
  "ê¸ˆìœµ": {
    template_id: "FINANCE",
    target_demographic: "30-55ì„¸",
    budget_allocation: { prospecting: 0.45, remarketing: 0.55 },
    benchmarks: { cpa: 35000, conversion_rate: 1.5, roas: 4.0 },
    audiences: {
      affinity: "ê¸ˆìœµ/íˆ¬ì, ë¹„ì¦ˆë‹ˆìŠ¤, ë¶€ë™ì‚°",
      inmarket: "ê¸ˆìœµ ì„œë¹„ìŠ¤, ëŒ€ì¶œ, ë³´í—˜",
      custom: "ëŒ€ì¶œ, ì‹ ìš©ì¹´ë“œ, ì ê¸ˆ, íˆ¬ì"
    },
    key_learnings: [
      "ë¦¬íƒ€ê²ŸíŒ… ë¹„ì¤‘ ë†’ì¼ìˆ˜ë¡ CPA ê°œì„ ",
      "ì‹ ë¢°ë„ ë©”ì‹œì§€(ë³´ì•ˆ, ì¸ì¦) ì¤‘ìš”",
      "ì—°ë§/ì—°ì´ˆ ê¸ˆìœµìƒí’ˆ ê´€ì‹¬ë„ ë†’ìŒ"
    ]
  },
  "ì´ì»¤ë¨¸ìŠ¤_íŒ¨ì…˜": {
    template_id: "ECOMMERCE_FASHION",
    target_demographic: "20-40ì„¸",
    budget_allocation: { prospecting: 0.55, remarketing: 0.45 },
    benchmarks: { cpa: 8000, conversion_rate: 3.5, roas: 4.5 },
    audiences: {
      affinity: "íŒ¨ì…˜/ë·°í‹°, ì‡¼í•‘, ë¼ì´í”„ìŠ¤íƒ€ì¼",
      inmarket: "ì˜ë¥˜/ì•¡ì„¸ì„œë¦¬, ì˜¨ë¼ì¸ ì‡¼í•‘",
      custom: "ì‹ ìƒ, í• ì¸, ì„¸ì¼, ë¸Œëœë“œëª…"
    },
    key_learnings: [
      "ì„¸ì¼ ì‹œì¦Œ(5ì›”, 11ì›”) ROAS 50% ìƒìŠ¹",
      "Dynamic Remarketing í•„ìˆ˜",
      "ì¸ìŠ¤íƒ€ê·¸ë¨/ìœ íŠœë¸Œ ì§€ë©´ íš¨ê³¼ì "
    ]
  },
  "ì„œë¹„ìŠ¤_ìš´ì„¸ìƒë‹´": {
    template_id: "SERVICE_FORTUNE",
    target_demographic: "20-50ì„¸",
    budget_allocation: { prospecting: 0.6, remarketing: 0.4 },
    benchmarks: { cpa: 10000, conversion_rate: 2.8, roas: 3.8 },
    audiences: {
      affinity: "ì ìˆ /ì´ˆìì—°, ìê¸°ê³„ë°œ, ë¼ì´í”„ìŠ¤íƒ€ì¼",
      inmarket: "ìš´ì„¸ ì„œë¹„ìŠ¤",
      custom: "ìš´ì„¸, ì‚¬ì£¼, íƒ€ë¡œ, ê¶í•©, ì‹ ì "
    },
    key_learnings: [
      "ì €ë… 7-12ì‹œ ì „í™˜ìœ¨ ì£¼ê°„ ëŒ€ë¹„ 2ë°°",
      "ì—¬ì„± 25-45ì„¸ ì „í™˜ìœ¨ ìµœê³ ",
      "'ë¬´ë£Œ' í‚¤ì›Œë“œ CTR 50% ìƒìŠ¹",
      "ì‹ ë…„/ìƒˆí•´ ì‹œì¦Œ CPA 20% ê°ì†Œ"
    ]
  },
  "ê¸°íƒ€": {
    template_id: "GENERAL",
    target_demographic: "25-55ì„¸",
    budget_allocation: { prospecting: 0.5, remarketing: 0.5 },
    benchmarks: { cpa: 20000, conversion_rate: 2.0, roas: 3.0 },
    audiences: {
      affinity: "ì¼ë°˜ ê´€ì‹¬ì‚¬",
      inmarket: "ê´€ë ¨ ì¹´í…Œê³ ë¦¬",
      custom: "ê´€ë ¨ í‚¤ì›Œë“œ"
    },
    key_learnings: [
      "ì—…ì¢…ë³„ ë²¤ì¹˜ë§ˆí¬ ì°¸ê³  í•„ìš”",
      "A/B í…ŒìŠ¤íŠ¸ë¡œ ìµœì  íƒ€ê²Ÿ ë°œêµ´ ê¶Œì¥"
    ]
  }
};

// Validation Checklist
const VALIDATION_CHECKS = [
  { id: "BV001", desc: "IO ì˜ˆì‚° í•©ê³„ = ì´ ì˜ˆì‚°", severity: "critical" },
  { id: "BV002", desc: "ì¼ì¼ ì˜ˆì‚° >= ëª©í‘œ CPA Ã— 10", severity: "warning" },
  { id: "BV003", desc: "Pacing ì„¤ì • ì ì ˆì„±", severity: "info" },
  { id: "TV001", desc: "ì˜¤ë””ì–¸ìŠ¤ ì¤‘ë³µ <= 30%", severity: "warning" },
  { id: "TV002", desc: "ì§€ì—­ íƒ€ê²ŸíŒ… ì¼ì¹˜", severity: "critical" },
  { id: "TV003", desc: "ë””ë°”ì´ìŠ¤ ë¹„ìœ¨ ë²¤ì¹˜ë§ˆí¬ Â±20%", severity: "info" },
  { id: "TV004", desc: "Frequency Cap ì ì ˆì„±", severity: "warning" },
  { id: "BD001", desc: "ëª©í‘œ CPA ë²¤ì¹˜ë§ˆí¬ ëŒ€ë¹„ í•©ë¦¬ì ", severity: "warning" },
  { id: "BD002", desc: "ëª©í‘œ ROAS ë‹¬ì„± ê°€ëŠ¥", severity: "warning" },
  { id: "BD003", desc: "ì…ì°° ì „ëµ ë°ì´í„° ìš”êµ¬ì‚¬í•­ ì¶©ì¡±", severity: "critical" },
  { id: "SV001", desc: "ìº í˜ì¸-IO-LI ê³„ì¸µ êµ¬ì¡° ì •ìƒ", severity: "critical" },
  { id: "SV002", desc: "ë„¤ì´ë° ê·œì¹™ ì¤€ìˆ˜", severity: "info" },
  { id: "SV003", desc: "Line Item ìˆ˜ ì ì • (IOë‹¹ 2-5ê°œ)", severity: "warning" },
  { id: "TK001", desc: "Floodlight íƒœê·¸ ì„¤ì •", severity: "critical" },
  { id: "TK002", desc: "ì „í™˜ ì°½ ì„¤ì • ì ì ˆ", severity: "info" }
];

// Seasonality
function getSeasonality(industry) {
  const month = new Date().getMonth() + 1;
  let seasonality = { isPeak: false, adjustment: 1.0, notes: [] };

  if (industry === "ì„œë¹„ìŠ¤_ìš´ì„¸ìƒë‹´" && [1, 12].includes(month)) {
    seasonality = { isPeak: true, adjustment: 1.2, notes: ["ì‹ ë…„ ì‹œì¦Œ: CPA 20% ê°ì†Œ ì˜ˆìƒ"] };
  } else if (industry === "êµìœ¡" && [2, 3, 8, 9].includes(month)) {
    seasonality = { isPeak: true, adjustment: 0.8, notes: ["ì‹ í•™ê¸° ì‹œì¦Œ: CPA 40% ê°ì†Œ ì˜ˆìƒ"] };
  } else if (industry === "ì´ì»¤ë¨¸ìŠ¤_íŒ¨ì…˜" && [5, 11].includes(month)) {
    seasonality = { isPeak: true, adjustment: 1.3, notes: ["ì„¸ì¼ ì‹œì¦Œ: ë¦¬íƒ€ê²ŸíŒ… í™•ëŒ€ ê¶Œì¥"] };
  }

  return seasonality;
}

// Strategy Generator
function generateStrategy(input) {
  const template = GOLDEN_DATASET[input.industry] || GOLDEN_DATASET["ê¸°íƒ€"];
  const seasonality = getSeasonality(input.industry);
  const now = new Date();

  // Budget allocation
  const prospectingBudget = Math.round(input.budget * template.budget_allocation.prospecting);
  const remarketingBudget = input.budget - prospectingBudget;

  // Generate IOs
  const insertionOrders = [
    {
      io_name: "IO_Prospecting",
      budget: prospectingBudget,
      pacing: "Even",
      line_items: [
        {
          li_name: "LI_Affinity",
          targeting: { audience: `Affinity: ${template.audiences.affinity}`, geo: input.geoTargets, device: "Mobile 80% / Desktop 20%" },
          bidding: { strategy: "Maximize Conversions", target_value: null },
          frequency_cap: "3íšŒ/ì¼, 15íšŒ/ì£¼"
        },
        {
          li_name: "LI_Custom_Intent",
          targeting: { audience: `Custom: ${template.audiences.custom}`, geo: input.geoTargets, device: "Mobile 80% / Desktop 20%" },
          bidding: { strategy: input.kpiType === "CPA" ? "Target CPA" : "Target ROAS", target_value: input.kpiTarget },
          frequency_cap: "4íšŒ/ì¼, 20íšŒ/ì£¼"
        }
      ]
    },
    {
      io_name: "IO_Remarketing",
      budget: remarketingBudget,
      pacing: "ASAP",
      line_items: [
        {
          li_name: "LI_SiteVisitors",
          targeting: { audience: "1st Party - ì‚¬ì´íŠ¸ ë°©ë¬¸ì (ìµœê·¼ 7ì¼)", geo: input.geoTargets, device: "Mobile 80% / Desktop 20%" },
          bidding: { strategy: input.kpiType === "CPA" ? "Target CPA" : "Target ROAS", target_value: input.kpiType === "CPA" ? Math.round(input.kpiTarget * 0.8) : Math.round(input.kpiTarget * 1.1) },
          frequency_cap: "5íšŒ/ì¼, 25íšŒ/ì£¼"
        },
        {
          li_name: "LI_Converters_Similar",
          targeting: { audience: "Similar - ê¸°ì¡´ ì „í™˜ì ìœ ì‚¬ ì˜¤ë””ì–¸ìŠ¤", geo: input.geoTargets, device: "Mobile 80% / Desktop 20%" },
          bidding: { strategy: input.kpiType === "CPA" ? "Target CPA" : "Target ROAS", target_value: input.kpiTarget },
          frequency_cap: "3íšŒ/ì¼, 15íšŒ/ì£¼"
        }
      ]
    }
  ];

  // Validation
  const validation = runValidation(input, insertionOrders, template);

  // Build strategy object
  const strategy = {
    productService: input.productService,
    metadata: {
      generated_at: now.toISOString(),
      generator_version: "2026Q1-Web",
      grade: validation.grade
    },
    campaign: {
      name: `DV360_${input.industry}_${now.getFullYear()}${String(now.getMonth()+1).padStart(2,'0')}`,
      goal: input.campaignGoal,
      budget: input.budget,
      duration_days: input.duration
    },
    insertion_orders: insertionOrders,
    targeting: {
      primary_audience: input.targetDemo,
      geo_targets: [input.geoTargets],
      device_split: "Mobile 80% / Desktop 20%",
      time_targeting: "ì „ ì‹œê°„ëŒ€ (ì €ë… 7-11ì‹œ ì…ì°° ìƒí–¥)",
      exclusions: ["ê¸°ì¡´ ì „í™˜ ê³ ê° (90ì¼)", "ê²½ìŸì‚¬ ì§ì›"]
    },
    bidding: {
      primary_strategy: `Target ${input.kpiType}`,
      target_value: input.kpiType === "CPA" ? `${input.kpiTarget.toLocaleString()}ì›` : `${input.kpiTarget}%`,
      phase_1: "Maximize Conversions (1-2ì£¼)",
      phase_2: `Target ${input.kpiType} (2-4ì£¼)`,
      seasonality_adjustment: seasonality.adjustment
    },
    optimization_roadmap: [
      {
        phase: "Phase 1: í•™ìŠµ (Week 1-2)",
        actions: ["Maximize Conversions ì „ëµìœ¼ë¡œ ì‹œì‘", "ì „ì²´ ì˜ˆì‚°ì˜ 70% í™œìš©", "A/B í…ŒìŠ¤íŠ¸ ì…‹ì—…"],
        kpis: ["ì „í™˜ ìˆ˜", "CPM", "CTR"]
      },
      {
        phase: "Phase 2: ìµœì í™” (Week 3-4)",
        actions: [`Target ${input.kpiType} ì „í™˜`, "ì €ì„±ê³¼ Line Item ì˜ˆì‚° ì¬ë°°ë¶„", "ê³ ì„±ê³¼ ì˜¤ë””ì–¸ìŠ¤ í™•ì¥"],
        kpis: [input.kpiType, "ì „í™˜ìœ¨", "ROAS"]
      }
    ],
    floodlight: {
      activities: ["Lead/Purchase Counter", "PageView Counter"],
      audience_lists: ["All Visitors (30ì¼)", "Product Viewers (14ì¼)", "Cart Abandoners (7ì¼)", "Converters (90ì¼) - Exclusionìš©"]
    },
    validation: validation,
    benchmarks: {
      industry: input.industry,
      benchmark_cpa: `${template.benchmarks.cpa.toLocaleString()}ì›`,
      benchmark_cvr: `${template.benchmarks.conversion_rate}%`,
      benchmark_roas: `${template.benchmarks.roas}x`,
      key_learnings: template.key_learnings
    },
    seasonality: seasonality
  };

  return strategy;
}

// Validation
function runValidation(input, ios, template) {
  const results = { passed: [], warnings: [], critical_failures: [], score: 0, grade: "" };

  let passCount = 0;
  const totalChecks = VALIDATION_CHECKS.length;

  VALIDATION_CHECKS.forEach(check => {
    let passed = true;
    let message = "";

    // Specific checks
    if (check.id === "BV001") {
      const ioTotal = ios.reduce((sum, io) => sum + io.budget, 0);
      passed = ioTotal === input.budget;
      if (!passed) message = `IO í•©ê³„(${ioTotal.toLocaleString()}) â‰  ì´ì˜ˆì‚°(${input.budget.toLocaleString()})`;
    } else if (check.id === "BV002") {
      const dailyBudget = input.budget / input.duration;
      passed = input.kpiType !== "CPA" || dailyBudget >= input.kpiTarget * 10;
      if (!passed) message = `ì¼ì¼ ì˜ˆì‚°ì´ ëª©í‘œ CPAì˜ 10ë°° ë¯¸ë§Œ`;
    } else if (check.id === "BD001") {
      if (input.kpiType === "CPA") {
        const benchCpa = template.benchmarks.cpa;
        passed = input.kpiTarget >= benchCpa * 0.5 && input.kpiTarget <= benchCpa * 2;
        if (!passed) message = `ëª©í‘œ CPAê°€ ë²¤ì¹˜ë§ˆí¬(${benchCpa.toLocaleString()}ì›) ëŒ€ë¹„ ë¹„í˜„ì‹¤ì `;
      }
    }

    if (passed) {
      passCount++;
      results.passed.push({ ...check, passed: true });
    } else if (check.severity === "critical") {
      results.critical_failures.push({ ...check, passed: false, message });
    } else {
      results.warnings.push({ ...check, passed: false, message });
    }
  });

  results.score = (passCount / totalChecks) * 100;

  // Grade calculation
  if (results.critical_failures.length === 0 && results.score >= 95) {
    results.grade = "S";
  } else if (results.critical_failures.length === 0 && results.score >= 85) {
    results.grade = "A";
  } else if (results.critical_failures.length === 0 && results.score >= 70) {
    results.grade = "B";
  } else if (results.critical_failures.length <= 2) {
    results.grade = "C";
  } else {
    results.grade = "D";
  }

  return results;
}

// ============================================================================
// UI Rendering
// ============================================================================

let currentStrategy = null;

function renderResult(strategy) {
  currentStrategy = strategy;

  const html = `
    <!-- Grade Section -->
    <div class="grade-section">
      <h3 style="color: #667eea; margin-bottom: 15px; font-size: 1.2rem;">${currentStrategy.productService} DV360 ìº í˜ì¸ì „ëµ</h3>
      <div class="grade-badge grade-${strategy.metadata.grade}">${strategy.metadata.grade}</div>
      <div class="grade-score">ê²€ì¦ ì ìˆ˜: ${strategy.validation.score.toFixed(1)}% | ${strategy.validation.passed.length}ê°œ í†µê³¼</div>
    </div>

    <!-- KPI Grid -->
    <div class="kpi-grid">
      <div class="kpi-card">
        <div class="value">${(strategy.campaign.budget / 10000).toFixed(0)}ë§Œì›</div>
        <div class="label">ì´ ì˜ˆì‚°</div>
      </div>
      <div class="kpi-card">
        <div class="value">${strategy.bidding.target_value}</div>
        <div class="label">ëª©í‘œ ${strategy.bidding.primary_strategy.replace('Target ', '')}</div>
      </div>
      <div class="kpi-card">
        <div class="value">${strategy.campaign.duration_days}ì¼</div>
        <div class="label">ìº í˜ì¸ ê¸°ê°„</div>
      </div>
      <div class="kpi-card">
        <div class="value">${strategy.benchmarks.benchmark_cvr}</div>
        <div class="label">ì˜ˆìƒ ì „í™˜ìœ¨</div>
      </div>
    </div>

    ${strategy.seasonality.isPeak ? `
    <div class="info-box success">
      <strong>ì‹œì¦Œ ì–´ë“œë°´í‹°ì§€:</strong> ${strategy.seasonality.notes.join(', ')}
    </div>
    ` : ''}

    <!-- Tabs -->
    <div class="tabs">
      <div class="tab active" data-tab="structure">ìº í˜ì¸ êµ¬ì¡°</div>
      <div class="tab" data-tab="targeting">íƒ€ê²ŸíŒ…</div>
      <div class="tab" data-tab="bidding">ì…ì°° ì „ëµ</div>
      <div class="tab" data-tab="validation">ê²€ì¦ ê²°ê³¼</div>
    </div>

    <!-- Tab: Structure -->
    <div class="tab-content active" id="tab-structure">
      <h3 style="margin-bottom: 15px;">ì˜ˆì‚° ë°°ë¶„</h3>
      <div class="budget-bar">
        <div class="budget-segment" style="width: ${strategy.insertion_orders[0].budget / strategy.campaign.budget * 100}%; background: #667eea;">
          í”„ë¡œìŠ¤í™íŒ… ${(strategy.insertion_orders[0].budget / strategy.campaign.budget * 100).toFixed(0)}%
        </div>
        <div class="budget-segment" style="width: ${strategy.insertion_orders[1].budget / strategy.campaign.budget * 100}%; background: #34a853;">
          ë¦¬íƒ€ê²ŸíŒ… ${(strategy.insertion_orders[1].budget / strategy.campaign.budget * 100).toFixed(0)}%
        </div>
      </div>

      <h3 style="margin: 20px 0 15px;">Insertion Orders</h3>
      <table>
        <tr>
          <th>IO Name</th>
          <th>ì˜ˆì‚°</th>
          <th>Pacing</th>
          <th>Line Items</th>
        </tr>
        ${strategy.insertion_orders.map(io => `
        <tr>
          <td><strong>${io.io_name}</strong></td>
          <td>${io.budget.toLocaleString()}ì›</td>
          <td>${io.pacing}</td>
          <td>${io.line_items.map(li => li.li_name).join(', ')}</td>
        </tr>
        `).join('')}
      </table>

      <h3 style="margin: 20px 0 15px;">Line Items ìƒì„¸</h3>
      <table>
        <tr>
          <th>Line Item</th>
          <th>ì˜¤ë””ì–¸ìŠ¤</th>
          <th>ì…ì°°</th>
          <th>Freq Cap</th>
        </tr>
        ${strategy.insertion_orders.flatMap(io => io.line_items.map(li => `
        <tr>
          <td>${li.li_name}</td>
          <td>${li.targeting.audience}</td>
          <td>${li.bidding.strategy}${li.bidding.target_value ? ` (${li.bidding.target_value})` : ''}</td>
          <td>${li.frequency_cap}</td>
        </tr>
        `)).join('')}
      </table>
    </div>

    <!-- Tab: Targeting -->
    <div class="tab-content" id="tab-targeting">
      <table>
        <tr><th>í•­ëª©</th><th>ì„¤ì •ê°’</th></tr>
        <tr><td>Primary Audience</td><td>${strategy.targeting.primary_audience}</td></tr>
        <tr><td>ì§€ì—­</td><td>${strategy.targeting.geo_targets.join(', ')}</td></tr>
        <tr><td>ë””ë°”ì´ìŠ¤</td><td>${strategy.targeting.device_split}</td></tr>
        <tr><td>ì‹œê°„ëŒ€</td><td>${strategy.targeting.time_targeting}</td></tr>
        <tr><td>ì œì™¸ ì˜¤ë””ì–¸ìŠ¤</td><td>${strategy.targeting.exclusions.join(', ')}</td></tr>
      </table>

      <h3 style="margin: 20px 0 15px;">ì—…ì¢… ì¸ì‚¬ì´íŠ¸</h3>
      <div class="info-box info">
        <ul>
          ${strategy.benchmarks.key_learnings.map(l => `<li>${l}</li>`).join('')}
        </ul>
      </div>
    </div>

    <!-- Tab: Bidding -->
    <div class="tab-content" id="tab-bidding">
      <table>
        <tr><th>í•­ëª©</th><th>ì„¤ì •ê°’</th></tr>
        <tr><td>Primary Strategy</td><td>${strategy.bidding.primary_strategy}</td></tr>
        <tr><td>ëª©í‘œê°’</td><td>${strategy.bidding.target_value}</td></tr>
        <tr><td>Phase 1</td><td>${strategy.bidding.phase_1}</td></tr>
        <tr><td>Phase 2</td><td>${strategy.bidding.phase_2}</td></tr>
      </table>

      <h3 style="margin: 20px 0 15px;">ë²¤ì¹˜ë§ˆí¬ ë¹„êµ</h3>
      <table>
        <tr><th>ì§€í‘œ</th><th>ì—…ì¢… ë²¤ì¹˜ë§ˆí¬</th></tr>
        <tr><td>CPA</td><td>${strategy.benchmarks.benchmark_cpa}</td></tr>
        <tr><td>ì „í™˜ìœ¨</td><td>${strategy.benchmarks.benchmark_cvr}</td></tr>
        <tr><td>ROAS</td><td>${strategy.benchmarks.benchmark_roas}</td></tr>
      </table>

      <h3 style="margin: 20px 0 15px;">ìµœì í™” ë¡œë“œë§µ</h3>
      ${strategy.optimization_roadmap.map(phase => `
      <div class="info-box info">
        <strong>${phase.phase}</strong>
        <ul>${phase.actions.map(a => `<li>${a}</li>`).join('')}</ul>
        <small>KPIs: ${phase.kpis.join(', ')}</small>
      </div>
      `).join('')}
    </div>

    <!-- Tab: Validation -->
    <div class="tab-content" id="tab-validation">
      <ul class="validation-list">
        ${strategy.validation.passed.map(v => `
        <li class="validation-item pass">
          <span class="validation-icon">âœ“</span>
          <span>${v.id}: ${v.desc}</span>
        </li>
        `).join('')}
        ${strategy.validation.warnings.map(v => `
        <li class="validation-item warning">
          <span class="validation-icon">âš </span>
          <span>${v.id}: ${v.desc}${v.message ? ` - ${v.message}` : ''}</span>
        </li>
        `).join('')}
        ${strategy.validation.critical_failures.map(v => `
        <li class="validation-item fail">
          <span class="validation-icon">âœ—</span>
          <span>${v.id}: ${v.desc}${v.message ? ` - ${v.message}` : ''}</span>
        </li>
        `).join('')}
      </ul>
    </div>
  `;

  document.getElementById('resultContent').innerHTML = html;
  document.getElementById('btnDownloadPdf').disabled = false;

  // Tab switching
  document.querySelectorAll('.tab').forEach(tab => {
    tab.addEventListener('click', () => {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      tab.classList.add('active');
      document.getElementById(`tab-${tab.dataset.tab}`).classList.add('active');
    });
  });
}

// ============================================================================
// Event Handlers
// ============================================================================

document.getElementById('campaignForm').addEventListener('submit', function(e) {
  e.preventDefault();

  const input = {
    industry: document.getElementById('industry').value,
    productService: document.getElementById('productService').value,
    targetDemo: document.getElementById('targetDemo').value,
    funnelStage: document.getElementById('funnelStage').value,
    campaignGoal: document.getElementById('campaignGoal').value,
    budget: parseInt(document.getElementById('budget').value),
    duration: parseInt(document.getElementById('duration').value),
    kpiType: document.getElementById('kpiType').value,
    kpiTarget: parseInt(document.getElementById('kpiTarget').value),
    geoTargets: document.getElementById('geoTargets').value,
    constraints: document.getElementById('constraints').value
  };

  // Show loading
  document.getElementById('resultContent').innerHTML = `
    <div class="loading">
      <div class="spinner"></div>
      <p>ì „ëµ ìƒì„± ì¤‘...</p>
    </div>
  `;

  // Generate with slight delay for UX
  setTimeout(() => {
    const strategy = generateStrategy(input);
    renderResult(strategy);
  }, 800);
});

// PDF Download (print)
document.getElementById('btnDownloadPdf').addEventListener('click', () => {
  window.print();
});
</script>

</body>
</html>
